<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width">
	<title>powerplant Index</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	<link type="text/css" rel="stylesheet" href="styles/site.flatly.css">

</head>

<body>

<div class="navbar navbar-default navbar-fixed-top ">
<div class="container">
	<div class="navbar-header">
		<a class="navbar-brand" href="index.html">powerplant</a>
		<button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#topNavigation">
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
        </button>
	</div>
	<div class="navbar-collapse collapse" id="topNavigation">
		<ul class="nav navbar-nav">
			
			<li class="dropdown">
				<a href="namespaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="cli.html">cli</a></li><li><a href="cli.cli.html">cli.cli</a></li><li><a href="client.html">client</a></li><li><a href="client.AboutPage.html">client.AboutPage</a></li><li><a href="client.App.html">client.App</a></li><li><a href="client.CropEditPanel.html">client.CropEditPanel</a></li><li><a href="client.CropListItem.html">client.CropListItem</a></li><li><a href="client.CropsPage.html">client.CropsPage</a></li><li><a href="client.pouchdb.html">client.pouchdb</a></li><li><a href="client.redux.html">client.redux</a></li><li><a href="client.redux.actions.html">client.redux.actions</a></li><li><a href="client.redux.complex-actions.html">client.redux.complex-actions</a></li><li><a href="client.redux.reducers.html">client.redux.reducers</a></li><li><a href="client.redux.store.html">client.redux.store</a></li><li><a href="client.shared.html">client.shared</a></li><li><a href="client.shared.DropdownView.html">client.shared.DropdownView</a></li><li><a href="client.shared.EditPanel.html">client.shared.EditPanel</a></li><li><a href="client.shared.InputField.html">client.shared.InputField</a></li><li><a href="client.shared.ListItem.html">client.shared.ListItem</a></li><li><a href="client.shared.ListView.html">client.shared.ListView</a></li><li><a href="client.shared.logic.html">client.shared.logic</a></li><li><a href="client.shared.logic.input-field.html">client.shared.logic.input-field</a></li><li><a href="client.shared.logic.select-dropdown.html">client.shared.logic.select-dropdown</a></li><li><a href="client.shared.PaginatedList.html">client.shared.PaginatedList</a></li><li><a href="client.shared.SelectDropdown.html">client.shared.SelectDropdown</a></li><li><a href="client.shared.SelectDropdownWithSearch.html">client.shared.SelectDropdownWithSearch</a></li><li><a href="client.styles.html">client.styles</a></li><li><a href="client.views.html">client.views</a></li><li><a href="client.views.Header.html">client.views.Header</a></li><li><a href="client.worker.html">client.worker</a></li><li><a href="client.worker.worker.html">client.worker.worker</a></li><li><a href="client.worker.WorkerManager.html">client.worker.WorkerManager</a></li><li><a href="db.html">db</a></li><li><a href="db.matrix.html">db.matrix</a></li><li><a href="db.practicalplants.html">db.practicalplants</a></li><li><a href="server.html">server</a></li><li><a href="server.server.html">server.server</a></li><li><a href="server.utils.html">server.utils</a></li><li><a href="shared.html">shared</a></li><li><a href="shared.combinations.html">shared.combinations</a></li><li><a href="shared.companionship.html">shared.companionship</a></li><li><a href="shared.filter.html">shared.filter</a></li><li><a href="shared.practicalplants.html">shared.practicalplants</a></li><li><a href="shared.utils.html">shared.utils</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="classes.list.html" class="dropdown-toggle" data-toggle="dropdown">Classes<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="client.AboutPage.AboutPage.html">client.AboutPage.AboutPage</a></li><li><a href="client.App.App.html">client.App.App</a></li><li><a href="client.AppProvider.html">client.AppProvider</a></li><li><a href="client.CropEditPanel.CropEditPanel.html">client.CropEditPanel.CropEditPanel</a></li><li><a href="client.CropListItem.CropListItem.html">client.CropListItem.CropListItem</a></li><li><a href="client.CropsPage.CropsPage.html">client.CropsPage.CropsPage</a></li><li><a href="client.shared.DropdownView.DropdownView.html">client.shared.DropdownView.DropdownView</a></li><li><a href="client.shared.EditPanel.EditPanel.html">client.shared.EditPanel.EditPanel</a></li><li><a href="client.shared.InputField.InputField.html">client.shared.InputField.InputField</a></li><li><a href="client.shared.ListItem.ListItem.html">client.shared.ListItem.ListItem</a></li><li><a href="client.shared.ListView.ListView.html">client.shared.ListView.ListView</a></li><li><a href="client.shared.PaginatedList.PaginatedList.html">client.shared.PaginatedList.PaginatedList</a></li><li><a href="client.shared.SelectDropdown.SelectDropdown.html">client.shared.SelectDropdown.SelectDropdown</a></li><li><a href="client.shared.SelectDropdownWithSearch.SelectDropdownWithSearch.html">client.shared.SelectDropdownWithSearch.SelectDropdownWithSearch</a></li><li><a href="shared.combinations.Combinations.html">shared.combinations.Combinations</a></li>
				</ul>
			</li>
			
			<li class="dropdown">
				<a href="global.html" class="dropdown-toggle" data-toggle="dropdown">Global<b class="caret"></b></a>
				<ul class="dropdown-menu ">
					<li><a href="global.html">Global</a></li>
				</ul>
			</li>
			
		</ul>
        
            <div class="col-sm-3 col-md-3">
                <form class="navbar-form" role="search">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Search" name="q" id="search-input">
                        <div class="input-group-btn">
                            <button class="btn btn-default" id="search-submit"><i class="glyphicon glyphicon-search"></i></button>
                        </div>
                    </div>
                </form>
            </div>
        
	</div>

</div>
</div>


<div class="container" id="toc-content">
<div class="row">

	
	<div class="col-md-8">
	
		<div id="main">
			

	
	











	
	





    <section class="readme-section">
        <article><p>Developer Documentation for powerplant</p>
<p>Last updated: August 4th, 2019</p>
<h1>Introduction</h1>
<p>powerplant is a full-stack JS web app utilizing several external services and
many interlocking components. The aim of this document is to help you, as a
developer, to get familiar with all parts of the software. It should act as a
roadmap, showing you where each functionality of the software lies, and where
each new functionality belongs.</p>
<p>Helpful external documentation:</p>
<ul>
<li><a href="https://reactjs.org/docs/thinking-in-react.html">Thinking in React</a></li>
<li><a href="http://restfulwebapis.org/RESTful_Web_Services.pdf">RESTful Web Services</a></li>
<li><a href="https://redux.js.org/docs/introduction/ThreePrinciples.html">Redux principles</a></li>
<li><a href="http://es6-features.org/">ECMAScript 6 overview</a></li>
<li><a href="http://usejsdoc.org/">JSDoc documentation</a></li>
<li><a href="https://webpack.js.org/concepts/">webpack concepts</a></li>
<li><a href="https://mochajs.org/">Mocha test framework</a></li>
<li><a href="https://www.chaijs.com/guide/styles/">Chai assertion styles</a></li>
<li><a href="https://gist.github.com/yoavniran/1e3b0162e1545055429e">Chai cheat sheet for the expect style</a></li>
</ul>
<h1>Setup</h1>
<p>To start, you need to set up the development environment.</p>
<ol>
<li>Install <a href="https://nodejs.org/en/download/">Node</a>.</li>
<li>Run <code>git clone https://github.com/Ecohackerfarm/powerplant.git</code> to clone the git repository.</li>
<li>Run <code>npm install</code> to get all packages installed.</li>
<li>Generate a private key in secrets.js (easiest is to run <code>cp secrets.example.js secrets.js</code>).</li>
<li>Run <code>npm start</code> to start the server.</li>
<li>Run <code>npm run migrate</code> to migrate the database to PouchDB.</li>
<li>Point your browser to <code>http://localhost:8080/</code>.</li>
<li>Done!</li>
</ol>
<h2>Common Mistakes</h2>
<h3>Server doesn't start after NodeJS update:</h3>
<pre class="prettyprint source"><code>Error: The module '/home/justus/workspace/powerplant/node_modules/bcrypt/lib/binding/bcrypt_lib.node'
was compiled against a different Node.js version using
NODE_MODULE_VERSION 48. This version of Node.js requires
NODE_MODULE_VERSION 59. Please try re-compiling or re-installing
the module (for instance, using `npm rebuild` or `npm install`).
</code></pre>
<p>This means you updated NodeJS and the easiest way to solve this is to run.</p>
<pre class="prettyprint source lang-bash"><code>rm -R node_modules && npm install
</code></pre>
<h1>Architecture</h1>
<p>powerplant is a web app that is using Node.js on the server side and React
for the web UI. It uses PouchDB to synchronize data between the server and
clients. There is also a simple CLI that is used for testing and
maintenance.</p>
<h2>UI</h2>
<p>UI is built with React using the <code>react-bootstrap</code> library, but there have
been plans to move using a more complete UI component library, to avoid the
need to create basic components like list views from scratch.</p>
<p>Code is written in a subset of ES6 that is natively supported by modern
browsers. Babel is currently only used for translating JSX to JS.</p>
<p>Webpack is used to bundle all UI modules together.</p>
<h3>Redux store</h3>
<p>Redux is the be-all-end-all of the state of the application (with very
few exceptions, like form state). Every bit of user data is stored in
redux.</p>
<p>In addition, the <code>redux-persist</code> module saves the redux store in local
storage and reloads (&quot;rehydrates&quot;) it every time the user visits the
website. This is what allows users to save data without registering, and
speeds up the process of displaying registered users' data. It also
means that the website can be used offline if the page is loaded first.</p>
<h1>Crop database</h1>
<p>We use a large crop database that has been scraped from practicalplants.org.
The main purpose of having this data in the repository is to be able to
quickly set up the application for real use.</p>
<p>The crop database is also used for testing the functionality of the
application with real data.</p>
<h1>Developer documentation</h1>
<p>Developer documentation consists of this overview of the structure of the
project, and API documentation that is generated with JSDoc.</p>
<p>The documentation is also available
<a href="https://ecohackerfarm.github.io/powerplant">online</a>.</p>
<h2>JSDoc conventions</h2>
<p>Every directory and every file is marked with <code>@namespace</code>. For directories,
this is done in file <code>index.js</code>. At the top of each file there should be a
jsdoc comment with the following structure. Take for example the file
<code>server/models/crop.js</code>:</p>
<pre class="prettyprint source"><code>/**
 * Mongoose model for crops.
 *
 * @namespace crop
 * @memberof server.models
 */
</code></pre>
<hr>
<p>Every function should have a jsdoc comment that documents the parameters
(<code>@param</code>) and the return value (<code>@return</code>). For example:</p>
<pre class="prettyprint source"><code>/**
 * Try to login with the given credentials.
 * 
 * @param {Object} credentials Username and password
 * @return {Object} Authorization token
 */
async login(credentials) {
</code></pre>
<hr>
<p>Every class should have a jsdoc comment like this:</p>
<pre class="prettyprint source"><code>/**
 * Represents the main content area of the application, in contrast to
 * Header which is the main navigation component.
 * 
 * @extends Component
 */
class Main extends React.Component {
</code></pre>
<h1>Tests</h1>
<p>Tests are in the <code>/test</code> directory. The directory structure should mirror
the root directory structure as close as possible.</p>
<p><a href="https://mochajs.org/">Mocha</a> is used as the test framework.</p>
<p><a href="https://www.chaijs.com/">Chai</a> is used as the assertion library. You may
choose either the expect or the assert style.</p>
<h2>Using <code>npm test</code> to study/play with a specific piece of code</h2>
<p>Sometimes when studying code it is easiest to write a local test to expose
its behavior. One way to do this is to use the <a href="https://mochajs.org/#exclusive-tests">exclusivity feature</a>
of Mocha to specify only the written test to be run with <code>npm test</code>.</p></article>
    </section>







		</div>
	</div>

	<div class="clearfix"></div>

	
		<div class="col-md-3">
			<div id="toc" class="col-md-3 hidden-xs hidden-sm hidden-md"></div>
		</div>
	

</div>
</div>


    <div class="modal fade" id="searchResults">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <h4 class="modal-title">Search results</h4>
          </div>
          <div class="modal-body"></div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div><!-- /.modal-content -->
      </div><!-- /.modal-dialog -->
    </div>


<footer>


<span class="jsdoc-message">
	Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.2</a>
	
		on Saturday, September 21st 2019, 5:02:51 pm
	
	using the <a href="https://github.com/docstrap/docstrap">DocStrap template</a>.
</span>
</footer>

<script src="scripts/docstrap.lib.js"></script>
<script src="scripts/toc.js"></script>

    <script type="text/javascript" src="scripts/fulltext-search-ui.js"></script>


<script>
$( function () {
	$( "[id*='$']" ).each( function () {
		var $this = $( this );

		$this.attr( "id", $this.attr( "id" ).replace( "$", "__" ) );
	} );

	$( ".tutorial-section pre, .readme-section pre, pre.prettyprint.source" ).each( function () {
		var $this = $( this );

		var example = $this.find( "code" );
		exampleText = example.html();
		var lang = /{@lang (.*?)}/.exec( exampleText );
		if ( lang && lang[1] ) {
			exampleText = exampleText.replace( lang[0], "" );
			example.html( exampleText );
			lang = lang[1];
		} else {
			var langClassMatch = example.parent()[0].className.match(/lang\-(\S+)/);
			lang = langClassMatch ? langClassMatch[1] : "javascript";
		}

		if ( lang ) {

			$this
			.addClass( "sunlight-highlight-" + lang )
			.addClass( "linenums" )
			.html( example.html() );

		}
	} );

	Sunlight.highlightAll( {
		lineNumbers : false,
		showMenu : true,
		enableDoclinks : true
	} );

	$.catchAnchorLinks( {
        navbarOffset: 10
	} );
	$( "#toc" ).toc( {
		anchorName  : function ( i, heading, prefix ) {
			return $( heading ).attr( "id" ) || ( prefix + i );
		},
		selectors   : "#toc-content h1,#toc-content h2,#toc-content h3,#toc-content h4",
		showAndHide : false,
		smoothScrolling: true
	} );

	$( "#main span[id^='toc']" ).addClass( "toc-shim" );
	$( '.dropdown-toggle' ).dropdown();

    $( "table" ).each( function () {
      var $this = $( this );
      $this.addClass('table');
    } );

} );
</script>



<!--Navigation and Symbol Display-->


<!--Google Analytics-->



    <script type="text/javascript">
        $(document).ready(function() {
            SearcherDisplay.init();
        });
    </script>


</body>
</html>