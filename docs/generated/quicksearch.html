<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" powerplant Namespaces serverserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migration Namespaces Namespaces server middleware authentication data-validation migration × Search results Close Documentation generated by JSDoc 3.5.3 on Friday, July 28th 2017, 11:57:30 pm using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" powerplant Namespaces serverserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migration Developer Documentation for powerplant Last updated: Jul 14, 2017 {{&gt;toc}} h1. Introduction powerplant is a full-stack JS web app utilizing several external services and many interlocking components. The aim of this doc is to help you, as a developer, get familiar with all the parts of the software. It should act as a roadmap, showing you where each functionality of the software lies, and where each new functionality belongs. h1. Architecture h2. Codebase The entire codebase, front and back, is written in ES6 using Babel to transpile to CommonJS. h2. Testing Tests are stored in the @/test@ folder. The structure of this folder should mirror the root file structure. This makes it easy to find the test module for any module. Tests should be written for every component that contains business logic or helper functions, as well as every API route. No tests need to be written for external library functions (like Mongoose @Models@). However, if you write an extensions to an external function, like a query function for a Mongoose @Model@, that should be tested. Whenever possible, use unit testing to test a single component separate from the rest of the codebase. If isolation is not possibe, integration tests are ok too. This is necessary for API tests, and possibly also for database functions. All tests are dispatched with Mocha and use the @expect@ function from the assertion library Chai. API tests use supertest to create requests. h3. Mocha https://mochajs.org/ Mocha is the test-running framework which is used to organize the tests. We use the BDD (behaviour-drive-development) syntax, so the main function used to organize tests is @describe@. Generally, tests for a module are organized with two levels of @describe, the first being the name of the module, and the second being for a specific function or functionality. Test code then goes within the secondFor example: describe('data-validation', () =&gt; { // module name describe('#idValidation()', () =&gt; { // function name // test code for idValidation goes here }); describe('#getCompanionshipScores()', () =&gt; { // other function name // test code for getCompanionshipScores }); }); describe('authReducer', () =&gt; { } h3. Chai h3. Supertest h2. Front end h3. React, react-router-dom h3. Redux h3. React-bootstrap h3. Webpack h2. Back end h3. Node h3. Express h3. Mongoose h1. Common tasks h2. Front end h3. Adding tests h3. Adding a new page h2. Back end h3. Adding tests h4. Unit tests h4. Integration tests h3. Modifying the database structure × Search results Close Documentation generated by JSDoc 3.5.3 on Friday, July 28th 2017, 11:57:30 pm using the DocStrap template. "},"server.html":{"id":"server.html","title":"Namespace: server","body":" powerplant Namespaces serverserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migration Namespace: server server Namespaces middleware migration × Search results Close Documentation generated by JSDoc 3.5.3 on Friday, July 28th 2017, 11:57:30 pm using the DocStrap template. "},"server.middleware.html":{"id":"server.middleware.html","title":"Namespace: middleware","body":" powerplant Namespaces serverserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migration Namespace: middleware server. middleware Express middleware functions Namespaces authentication data-validation × Search results Close Documentation generated by JSDoc 3.5.3 on Friday, July 28th 2017, 11:57:30 pm using the DocStrap template. "},"server.middleware.authentication.html":{"id":"server.middleware.authentication.html","title":"Namespace: authentication","body":" powerplant Namespaces serverserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migration Namespace: authentication server.middleware. authentication Authentication express middleware functions Methods &lt;static&gt; authenticate(req, res, next) Express middleware to check if a request has authentication. If an authorization header exists, it will either save the user in req.user (if authenticated), or send a 401/404 depending if it's an invalid token or if the user doesn't exist If it doesn't exist, this function does nothing and calls next() Parameters: Name Type Description req Object request object res Object response object next function Returns: Type None × Search results Close Documentation generated by JSDoc 3.5.3 on Friday, July 28th 2017, 11:57:30 pm using the DocStrap template. "},"server.middleware.data-validation.html":{"id":"server.middleware.data-validation.html","title":"Namespace: data-validation","body":" powerplant Namespaces serverserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migration Namespace: data-validation server.middleware. data-validation Helper functions and middleware for data validation Methods &lt;static&gt; checkCompanionships(req, res, next) Expres middleware function generated by data-validation.checkModel Checks that each companionship associated with an id in req.ids exists. If one doesn't exist, sends 404 to client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None &lt;static&gt; checkCrops(req, res, next) Expres middleware function generated by data-validation.checkModel Checks that each crop associated with an id in req.ids exists. If one doesn't exist, sends 404 to client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None &lt;static&gt; checkLocations(req, res, next) Expres middleware function generated by data-validation.checkModel Checks that each location associated with an id in req.ids exists. If one doesn't exist, sends 404 to client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None &lt;static&gt; checkModel(model) Function factory to generate express middleware for checking if some ids exist in a model without fetching them See checkCrops for specifications of generated middleware Parameters: Name Type Description model Mongoose.Model model type to check Returns: express middleware function Type function &lt;static&gt; checkUsers(req, res, next) Expres middleware function generated by data-validation.checkModel Checks that each user associated with an id in req.ids exists. If one doesn't exist, sends 404 to client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None &lt;static&gt; escapeRegEx(text) Converts a string into regex-friendly format, escaping all regex special characters Parameters: Name Type Description text string string to convert Returns: escaped string Type string &lt;static&gt; fetchCompanionships(req, res, next) Express middleware function generated by data-validation.fetchModel Fetches all Companionships associated with ids in req.ids and stores them in req.companionships Also populates crop1 and crop2 with Crop objects If a companionship does not exist, it will send a 404 to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; fetchCrops(req, res, next) Express middleware function generated by data-validation.fetchModel Fetches all Crops associated with ids in req.ids and stores them in req.crops If a crop does not exist, it will send a 404 to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; fetchCropsWithCompanionships(req, res, next) Express middleware function generated by data-validation.fetchModel Same as data-validation.fetchCrops, but also populates the companionships of each crop with full Companionship objects, rather than just ids Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; fetchLocations(req, res, next) Express middleware function generated by data-validation.fetchModel Fetches all Locations associated with ids in req.ids and stores them in req.locations If a location does not exist, it will send a 404 to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; fetchModel(model, resultName [, populate]) A function factory to generate express middleware for fetching models. See data-validation.fetchCrops for specifications of generated function Parameters: Name Type Argument Default Description model Mongoose.Model Model type to be fetched resultName string name of the property in the request object where the fetched models will be stored populate string &lt;optional&gt; '' fields in the fetched models to populate Returns: Type function &lt;static&gt; fetchUsers(req, res, next) Express middleware function generated by data-validation.fetchModel Fetches all Users associated with ids in req.ids and stores them in req.users If a user does not exist, it will send a 404 to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; getCompanionshipScores(companionshipTable, ids) Processes an array of companionships and calculates compatibility scores for each possible crop Parameters: Name Type Description companionshipTable Array.&lt;Array.&lt;Companionship&gt;&gt; table of sets of Companionships for each crop in ids. All companionships for ids[i] are stored in companionshipTable[i] ids Array.&lt;ObjectId&gt; ids of crops used to fetch each Companionship. Returns: Object mapping crop ids to companionship scores Type Object &lt;static&gt; idValidator(req, res, next) Express middleware function Checks each id in req.ids to see if it is a valid ObjectId. If not, sends a 400 error to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;string&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None × Search results Close Documentation generated by JSDoc 3.5.3 on Friday, July 28th 2017, 11:57:30 pm using the DocStrap template. "},"server.migration.html":{"id":"server.migration.html","title":"Namespace: migration","body":" powerplant Namespaces serverserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migration Namespace: migration server. migration Methods &lt;static&gt; migrateCompanionships() Migrate the companionships from the Firebase database to the local mongodb database Requires that all the crops be done migrating first Returns: Type None &lt;static&gt; migrateCrops() Migrate all crops from firebase to local mongodb database Returns: passes the migrated crops to resolve once they all finish migrating Type Promise × Search results Close Documentation generated by JSDoc 3.5.3 on Friday, July 28th 2017, 11:57:30 pm using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
