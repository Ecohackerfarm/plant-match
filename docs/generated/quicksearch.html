<html>
<head>
</head>
<body style="background: transparent;">
    <script src="scripts/docstrap.lib.js"></script>
    <script src="scripts/lunr.min.js"></script>
    <script src="scripts/fulltext-search.js"></script>

    <script type="text/x-docstrap-searchdb">
    {"classes.list.html":{"id":"classes.list.html","title":"Classes","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Classes Classes Companionship Crop Location User Namespaces client actions headerActions locationActions server app middleware authentication data-validation migration models × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:14 am using the DocStrap template. "},"namespaces.list.html":{"id":"namespaces.list.html","title":"Namespaces","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespaces Classes Companionship Crop Location User Namespaces client actions headerActions locationActions server app middleware authentication data-validation migration models × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:14 am using the DocStrap template. "},"index.html":{"id":"index.html","title":"Index","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Developer Documentation for powerplant Last updated: Jul 28, 2017 {{&gt;toc}} h1. Introduction powerplant is a full-stack JS web app utilizing several external services and many interlocking components. The aim of this doc is to help you, as a developer, get familiar with all the parts of the software. It should act as a roadmap, showing you where each functionality of the software lies, and where each new functionality belongs. It would be helpful to have A bit of working knowledge of javascript ** ES6 standards are a plus Understanding of JS @Promises@ Understanding of the principles behind building a React app - see &quot;Thinking in React&quot;:https://facebook.github.io/react/docs/thinking-in-react.html Knowledge of REST principles for building web APIs - see &quot;RESTful Web Services&quot;:http://restfulwebapis.org/RESTful_Web_Services.pdf NOTE These would just be helpful. If you're like me, you started with none of these except for a bit of JS. RELATED If you see something in these docs that you think should be changed or see existing code that you think is leading the project down the wrong path and needs to be refactored or restructured, PLEASE work to change it! The project is in its early stages, and there are many features or implementation details that made it through simply because the project is so small. Also, I apologize if you find any awful code. You can send questions, complaints, or hate mail to simoneverhale@gmail.com h1. Setup To start, you need to set up the development environment. This includes: NodeJS, Docker (with mongo db) &quot;Install Node&quot;:https://nodejs.org/en/download/package-manager/ you should install version 6.x&quot;Install Docker&quot;:https://docs.docker.com/engine/installation/linux/docker-ce/ubuntu/#install-using-the-repositoryInstall the &quot;Mongo Docker image&quot;:https://hub.docker.com/_/mongo/ by running @docker pull mongo@Clone the &quot;git repository&quot;:https://github.com/Ecohackerfarm/powerplant.gitStart the Docker image by running @npm run mongo@Run the Firebase data migration by running @npm run migrate@At this point, everything should be set up. Run @npm test@ to make sure everything is working, and @npm start@ to begin serving the website on @http://localhost:8080@Done!h1. Architecture h2. Codebase The entire codebase, front and back, is written in ES6 using Babel to transpile to CommonJS. h2. Documentation Documentation can be found in the @/docs@ folder. @/docs/index.html@ loads a fully navigatible documentation site. h3. JSDoc All documentation is generated with JSDoc (and &quot;docstrap&quot;:https://www.npmjs.com/package/ink-docstrap for the template). See the http://usejsdoc.org/ for documentation on how to properly document things. The documentation pattern used is to make every folder and file a namespace (unless a file should not be its own namespace, like if you only ever import it through the directory's index.js). Each @namespace@ should also specify who it is a @memberof@. This allows for proper navigation of the file hierarchy in the documentation. Additionally, a plugin called &quot;jsdoc-memberof-namespace&quot;:https://www.npmjs.com/package/jsdoc-memberof-namespace is used to generate proper nesting structure for methods, constants, and classes within namespaces. This was the best way I could find to maintain the right file hierarchy in the documentation. Here's an example for documenting a file called @bar@ within a folder called @foo@ (although you should be able to find plenty in the code, at least in @/server/data-validation@) File: /foo/index.js /** * @namespace foo */ File: /example/foo/bar /** * @namespace bar * @memberof foo */ Pretty simple, right? Make sure to specify the full namespace in @memberof@, e.g. if foo was contained within baz, in bar you'd say it's a member of @baz.foo@, not just @foo@. You might need to add a few index.js files if there are folders that don't have them already. NOTE: If you notice a function being skipped in the documentation, check if it's a default export! jsdoc-memberof-namespace has trouble with inline default export function declarations. Better to declare the function, then default export it, otherwise it may be skipped. h2. Testing You can run tests with the @npm test@ command. Note that in order to test the server code correctly, the tests must be able to connect to the mongo docker image. This connection happens in @/test/server/init.js@. You also need to have migrated the data to the mongodb database with @npm run migrate@. If you ever get a few odd failed tests (&quot;cannot get property '_id'&quot; or something like that), it's possible you forgot to migrate the data. Tests are stored in the @/test@ folder. The structure of this folder should mirror the root file structure. This makes it easy to find the test module for any module. Tests should be written for every component that contains business logic or helper functions, as well as every API route. No tests need to be written for external library functions (like Mongoose @Models@). However, if you write an extensions to an external function, like a query function for a Mongoose @Model@, that should be tested. Whenever possible, use unit testing to test a single component separate from the rest of the codebase. If isolation is not possibe, integration tests are ok too. This is necessary for API tests, and possibly also for database functions. All tests are dispatched with Mocha and use the @expect@ function from the assertion library Chai. API tests use supertest to create requests. h3. Mocha https://mochajs.org/ Mocha is the test-running framework which is used to organize the tests. It is used by the @npm test@ command as the environment in which the tests are run, so it does not need to be imported in any of the test classes. We use the BDD (behaviour-drive-development) syntax, so the main functions used to organize tests are @describe@ and @it@. @describe@ is used to separate modules and functionalities within modules, and @it@ is used to describe a specific behaviour. Generally, tests for a module are organized with two levels of @describe@, the first being the name of the module, and the second being for a specific function or functionality. Test code then goes within an @it@ function in the second. For example: describe('data-validation', () =&gt; { // module name describe('#idValidation()', () =&gt; { // function name it('should validate a correct id', () = &gt; { // test code goes here }); }); describe('#getCompanionshipScores()', () =&gt; { // other function name it('should return correct scores', () =&gt; { // test code goes here }); }); }); or describe('authReducer', () =&gt; { // module name describe('SET_CURRENT_USER', () =&gt; { //not a function, but a specific functionality it(&quot;should set the current user&quot;, () =&gt; { // test code goes here }); }); }); Mocha tests run synchronously, but it does support asynchronous test code through the use of promises. To test asynchronous code, simply have the @it@ function return a promise. The next test will not execute until the promise is resolved. h3. Chai http://chaijs.com/, &quot;cheat sheet&quot;:https://gist.github.com/yoavniran/1e3b0162e1545055429e Tests use the @expect@ function of Chai to assert that all things are as they should be. Each @expect@ call is an opportunity for a test to fail. If all @expect@ calls in an @it()@ function pass, the test passes. Chai supports function chaining to create self-documenting tests. See the cheat sheet above for an overview of the functions. h3. Supertest https://www.npmjs.com/package/supertest Supertest allows testing of network request-based functionality (REST API routes, in our case). See the tests in @/test/server/routes/api/@ for examples. A supertest request return a promise, so it can be returned in an @it@ function and the test will wait until the request completes to continue. h2. Front end h3. React, react-router-dom h3. Redux + redux-peresist + react-redux Redux is the be-all-end-all of the state of the application (with very few exceptions, like form state). Every bit of user data is stored in redux. The store has the following architecture: { title: String (default: &quot;powerplant&quot;), // the title that will be displayed in the window auth: { isAuthenticated: Bool (default: false), currentUser: User (default: null), }, currLocation: Location (default: null), locations: [Location] (default: []), beds: [Bed] (default: []), crops: [Crop] (default: []), cropInfos: [CropInformation] (default: []), cropRelationships: [CropRelationship] (default: []) } In addition, the @redux-persist@ module saves the redux store in local storage and reloads (&quot;rehydrates&quot;) it every time the user visits the website. This is what allows users to save data without registering, and speeds up the process of displaying registered users' data. It also means that the website can be used offline if the page is loaded first. h3. React-bootstrap h3. Webpack h2. Back end h3. Node h3. Express h3. Mongoose Mongoose is an ODM (object-document-model) library for Mongo DB. It abstracts some of the lower level features of mongo and makes it easy to create models and control them. The database structure follows a relatively straightforward hierarchy: +------------------------------------+ | User | +------------------------------------+ | _id:ObjectId | | username:String | | password:String | | locations:[ObjectId(ref:Location)] | | | +n------------^----------------------+ | | | | | user locations | | | | | +v------------1+---------------+ | Location | +------------------------------+ | _id:ObjectId | | beds:[Bed] | | loc:{coordinates:[Number], | | address:String} | | user:ObjectId(ref:User) | | | +----n--------------^----------+ | | beds location | | +----v--------------1-----------------+ | Bed | +-------------------------------------+ | _id:ObjectId | | active_crops:[ObjectId(ref:Crop)] | | past_crops:[ObjectId(ref:Crop)] | | soil_type:Enum | | location:ObjectId(ref:Location) | | | | | +-----n------------^------------------+ | | active_crops | past_crops bed | | +-----v------------1----------------------+ | Crop | +-----------------------------------------+ | _id:ObjectId | | bed:ObjectId(ref:Bed) | | crop_info:ObjectId(ref:CropInformation)| | planted_indoors:Date | | planted_in_bed:Date | | predicted_transplant:Date | | predicted_harVest:Date | +-----------------------------------------+ h1. Common tasks h2. Front end h3. Adding tests h3. Adding a new page h2. Back end h3. Adding tests h4. Unit tests h4. Integration tests h3. Modifying the database structure × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:14 am using the DocStrap template. "},"server.models.User.html":{"id":"server.models.User.html","title":"Class: User","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Class: User server.models. User new User(user [, locations]) Mongoose User model When fetched with a query, unless explicitly selecting other fields, only the username and id will be returned Parameters: Name Type Argument Description user Object Properties Name Type Description username String email String password String passed in plaintext, but will be salted and hashed on save locations Array.&lt;ObjectId&gt; | Array.&lt;server.models.Location&gt; &lt;optional&gt; ids of all locations stored under the user Methods checkPassword(password, callback) Parameters: Name Type Description password String hashed password to check callback server.models.User~passwordCheckCallback callback function when done checking Returns: Type None &lt;static&gt; byUsername(username) Custom query method for finding a single User by their username Parameters: Name Type Description username String exact username to find Returns: Type Mongoose.Query Example // fetch the user with username &quot;testUser&quot; User.find().byUsername(&quot;testUser&quot;).exec((err, user) =&gt; { // do something with user }) Type Definitions passwordCheckCallback(err, success) Parameters: Name Type Description err String error message, if there was one success Boolean did the passwords match or not? × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:14 am using the DocStrap template. "},"client.html":{"id":"client.html","title":"Namespace: client","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: client client Namespaces actions × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:14 am using the DocStrap template. "},"client.actions.html":{"id":"client.actions.html","title":"Namespace: actions","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: actions client. actions Contains all possible redux actions Each one must be dispatch()'ed to function properly, they can't just be called like any other function Namespaces headerActions locationActions Type Definitions responseObject Response when an action is requested which involves adding new data Type: Object Properties: Name Type Description success Boolean was the action request successful? × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:14 am using the DocStrap template. "},"client.actions.headerActions.html":{"id":"client.actions.headerActions.html","title":"Namespace: headerActions","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: headerActions client.actions. headerActions Methods &lt;static&gt; setTitle(title) Returns an action to make a title change Parameters: Name Type Description title String the new title which will be displayed Returns: Type client.actions.headerActions.SET_TITLE Type Definitions SET_TITLE Pure action to set the title Type: Object Properties: Name Type Argument Default Description type String &lt;optional&gt; SET_TITLE title String new title to be displayed × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"client.actions.locationActions.html":{"id":"client.actions.locationActions.html","title":"Namespace: locationActions","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: locationActions client.actions. locationActions Methods &lt;static&gt; addLocation(location) Build an ADD_LOCATION action Parameters: Name Type Description location server.models.Location location to be added Returns: Type client.actions.locationActions.ADD_LOCATION &lt;static&gt; editLocation(before, after) Build an EDIT_LOCATION action Parameters: Name Type Description before server.models.Location [description] after server.models.Location [description] Returns: [description] Type client.actions.locationActions.EDIT_LOCATION &lt;static&gt; getLocationsRequest(id) Async sends a request to get all the user's locations On response, dispatches a SET_LOCATIONS action Parameters: Name Type Description id String id of users whose locations are being fetched Returns: the network request Type Promise &lt;static&gt; saveAllLocationsRequest(locations) Async makes a request to save an array of locations on the server, then updates them in the store if successful by dispatching EDIT_LOCATION requests Parameters: Name Type Description locations Array.&lt;server.model.Location&gt; locations to be saved Returns: resolves to a client.actions.responseObject Type Promise &lt;static&gt; saveLocationRequest(location) Async sends a request to save a location, dispatches an ADD_LOCATION action on success Parameters: Name Type Description location server.models.Location unlike server model, does not require an _id parameter Returns: resolves to a client.actions.responseObject Type Promise &lt;static&gt; setLocations(locations) Build a SET_LOCATIONS action Parameters: Name Type Description locations Array.&lt;server.models.Location&gt; Returns: Type client.actions.locationActions.SET_LOCATIONS Type Definitions ADD_LOCATION Pure action to add a single location Type: Object Properties: Name Type Argument Default Description type String &lt;optional&gt; ADD_LOCATION location server.models.Location location to be added EDIT_LOCATION Pure action to edit a location Type: Object Properties: Name Type Argument Default Description type String &lt;optional&gt; EDIT_LOCATION before server.models.Location the location to be replaced after server.models.Location the new location SET_LOCATIONS Pure action to set all locations in the redux store Will remove all current locations and replace them will the specified array Type: Object Properties: Name Type Argument Default Description type String &lt;optional&gt; SET_LOCATIONS locations Array.&lt;server.models.Location&gt; locations to replace the current locations in the store × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.html":{"id":"server.html","title":"Namespace: server","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: server server Namespaces app middleware migration models × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.app.html":{"id":"server.app.html","title":"Namespace: app","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: app server. app Holds the instance of the express app Members &lt;static, constant&gt; app :Object the express app Type: Object &lt;static, constant&gt; buildApp Sets up the express application with all middleware × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.middleware.html":{"id":"server.middleware.html","title":"Namespace: middleware","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: middleware server. middleware Express middleware functions Namespaces authentication data-validation × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.middleware.authentication.html":{"id":"server.middleware.authentication.html","title":"Namespace: authentication","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: authentication server.middleware. authentication Authentication express middleware functions Methods &lt;static&gt; authenticate(req, res, next) Express middleware to check if a request has authentication. If an authorization header exists, it will either save the user in req.user (if authenticated), or send a 401/404 depending if it's an invalid token or if the user doesn't exist If it doesn't exist, this function does nothing and calls next() Parameters: Name Type Description req Object request object res Object response object next function Returns: Type None × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.middleware.data-validation.html":{"id":"server.middleware.data-validation.html","title":"Namespace: data-validation","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: data-validation server.middleware. data-validation Helper functions and middleware for data validation Methods &lt;static&gt; checkCompanionships(req, res, next) Expres middleware function generated by data-validation.checkModel Checks that each companionship associated with an id in req.ids exists. If one doesn't exist, sends 404 to client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None &lt;static&gt; checkCrops(req, res, next) Expres middleware function generated by data-validation.checkModel Checks that each crop associated with an id in req.ids exists. If one doesn't exist, sends 404 to client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None &lt;static&gt; checkLocations(req, res, next) Expres middleware function generated by data-validation.checkModel Checks that each location associated with an id in req.ids exists. If one doesn't exist, sends 404 to client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None &lt;static&gt; checkModel(model) Function factory to generate express middleware for checking if some ids exist in a model without fetching them See checkCrops for specifications of generated middleware Parameters: Name Type Description model Mongoose.Model model type to check Returns: express middleware function Type function &lt;static&gt; checkUsers(req, res, next) Expres middleware function generated by data-validation.checkModel Checks that each user associated with an id in req.ids exists. If one doesn't exist, sends 404 to client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None &lt;static&gt; escapeRegEx(text) Converts a string into regex-friendly format, escaping all regex special characters Parameters: Name Type Description text String string to convert Returns: escaped string Type String &lt;static&gt; fetchCompanionships(req, res, next) Express middleware function generated by data-validation.fetchModel Fetches all Companionships associated with ids in req.ids and stores them in req.companionships Also populates crop1 and crop2 with Crop objects If a companionship does not exist, it will send a 404 to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; fetchCrops(req, res, next) Express middleware function generated by data-validation.fetchModel Fetches all Crops associated with ids in req.ids and stores them in req.crops If a crop does not exist, it will send a 404 to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; fetchCropsWithCompanionships(req, res, next) Express middleware function generated by data-validation.fetchModel Same as data-validation.fetchCrops, but also populates the companionships of each crop with full Companionship objects, rather than just ids Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; fetchLocations(req, res, next) Express middleware function generated by data-validation.fetchModel Fetches all Locations associated with ids in req.ids and stores them in req.locations If a location does not exist, it will send a 404 to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; fetchModel(model, resultName [, populate]) A function factory to generate express middleware for fetching models. See data-validation.fetchCrops for specifications of generated function Parameters: Name Type Argument Default Description model Mongoose.Model Model type to be fetched resultName String name of the property in the request object where the fetched models will be stored populate String &lt;optional&gt; '' fields in the fetched models to populate Returns: Type function &lt;static&gt; fetchUsers(req, res, next) Express middleware function generated by data-validation.fetchModel Fetches all Users associated with ids in req.ids and stores them in req.users If a user does not exist, it will send a 404 to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be fetched res Object response object next function callback to next function Returns: Type None &lt;static&gt; getCompanionshipScores(companionshipTable, ids) Processes an array of companionships and calculates compatibility scores for each possible crop Parameters: Name Type Description companionshipTable Array.&lt;Array.&lt;Companionship&gt;&gt; table of sets of Companionships for each crop in ids. All companionships for ids[i] are stored in companionshipTable[i] ids Array.&lt;ObjectId&gt; ids of crops used to fetch each Companionship. Returns: Object mapping crop ids to companionship scores Type Object &lt;static&gt; idValidator(req, res, next) Express middleware function Checks each id in req.ids to see if it is a valid ObjectId. If not, sends a 400 error to the client Parameters: Name Type Description req Object request object Properties Name Type Description ids Array.&lt;String&gt; List of ids to be checked res Object response object next function callback to next function Returns: Type None × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.migration.html":{"id":"server.migration.html","title":"Namespace: migration","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: migration server. migration Methods &lt;static&gt; migrateCompanionships() Migrate the companionships from the Firebase database to the local mongodb database Requires that all the crops be done migrating first Returns: Type None &lt;static&gt; migrateCrops() Migrate all crops from firebase to local mongodb database Returns: passes the migrated crops to resolve once they all finish migrating Type Promise × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.models.html":{"id":"server.models.html","title":"Namespace: models","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Namespace: models server. models Classes Companionship Crop Location User × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.models.Companionship.html":{"id":"server.models.Companionship.html","title":"Class: Companionship","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Class: Companionship server.models. Companionship new Companionship(companionship) Parameters: Name Type Description companionship Object Properties Name Type Argument Description crop1 ObectId | server.models.Crop id referencing the first crop crop2 ObectId | server.models.Crop id referencing the second crop description String &lt;optional&gt; description of the relationship compatibility Number compatibility score for the companionship Methods &lt;static&gt; byCrop(crop1 [, crop2]) Custom query for searching for a companionship by crop id Parameters: Name Type Argument Description crop1 ObjectId | server.models.Crop crop2 ObjectId | server.models.Crop &lt;optional&gt; Returns: Type Mongoose.Query Example // finds all companionships involving cropId Companionship.find().byCrop(cropId).exec((err, results) =&gt; { // do something with results }) × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.models.Crop.html":{"id":"server.models.Crop.html","title":"Class: Crop","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Class: Crop server.models. Crop new Crop(crop, companionships) This is all going to get overhauled eventually when integration with openfarm.cc happens... (or sooner, but I don't have time) Parameters: Name Type Description crop Object Properties Name Type Argument Description name String internal name display_name String display name 1 alternate_display String &lt;optional&gt; display name 2 companionships Array.&lt;ObjectId&gt; | Array.&lt;server.models.Companionship&gt; all companionships involving this crop Methods &lt;static&gt; byName(name) Custom mongoose query to find a Crop by its name (name, not display name or alternate display). Could be changed in the future Parameters: Name Type Description name String [description] Returns: [description] Type Mongoose.Query Example // find all crops matching &quot;bean&quot; Crop.find().byName(&quot;bean&quot;).exec((err, results) =&gt; { // do something with results }) × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "},"server.models.Location.html":{"id":"server.models.Location.html","title":"Class: Location","body":" powerplant Namespaces clientclient.actionsclient.actions.headerActionsclient.actions.locationActionsserverserver.appserver.middlewareserver.middleware.authenticationserver.middleware.data-validationserver.migrationserver.models Classes server.models.Companionshipserver.models.Cropserver.models.Locationserver.models.User Class: Location server.models. Location new Location(location) Mongoose location model Parameters: Name Type Description location Object Properties Name Type Argument Description user ObjectId | server.models.User id of the user owning this location loc Object &lt;optional&gt; the geographic location details Properties Name Type Argument Default Description type String &lt;optional&gt; &quot;Point&quot; location type, likely never needs to be anything but the default coordinates Array.&lt;Number&gt; an array of two coordinates in the order [lng, lat] address String the address of the location × Search results Close Documentation generated by JSDoc 3.5.3 on Saturday, July 29th 2017, 2:49:15 am using the DocStrap template. "}}
    </script>

    <script type="text/javascript">
        $(document).ready(function() {
            Searcher.init();
        });

        $(window).on("message", function(msg) {
            var msgData = msg.originalEvent.data;

            if (msgData.msgid != "docstrap.quicksearch.start") {
                return;
            }

            var results = Searcher.search(msgData.searchTerms);

            window.parent.postMessage({"results": results, "msgid": "docstrap.quicksearch.done"}, "*");
        });
    </script>
</body>
</html>
